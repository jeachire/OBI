% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/censoredRWmcmc.R
\name{censoredRWmcmc}
\alias{censoredRWmcmc}
\title{Random Walk Metropolis-Hastings with Right-Censoring Imputation}
\usage{
censoredRWmcmc(
  x,
  delta,
  dist,
  logPost,
  theta.init,
  positive,
  Sigma = NULL,
  n.iter = 5000,
  burnin = 1000,
  thin = 1
)
}
\arguments{
\item{x}{Numeric vector. Observed times (may include censored observations).}

\item{delta}{Integer or logical vector of the same length as \code{x}.
Indicator of censoring: \code{1} for observed events, \code{0} for right-censored.}

\item{dist}{Character string. Distribution used for imputing censored values.
Currently supports \code{"weibull"} and \code{"exponential"}.}

\item{logPost}{Function. Log-posterior function to evaluate.
Must take arguments \code{theta} (numeric vector of parameters)
and \code{t.imp} (data vector with imputed values).}

\item{theta.init}{Numeric vector. Initial parameter values.}

\item{positive}{Logical vector of the same length as \code{theta.init}.
Indicates which parameters are constrained to be positive. Default: all \code{FALSE}.}

\item{Sigma}{Covariance matrix for the Gaussian proposal distribution.
If \code{NULL}, a diagonal matrix with variance 0.1 is used.}

\item{n.iter}{Integer. Total number of MCMC iterations (default 5000).}

\item{burnin}{Integer. Number of initial iterations to discard (default 1000).}

\item{thin}{Integer. Thinning interval, i.e., keep every \code{thin}-th sample (default 1).}
}
\value{
A list with the following elements:
\describe{
\item{chain}{Matrix of sampled parameter values after burn-in and thinning.}
\item{summary}{Data frame with posterior mean, SD, median, and quantiles (2.5\\%, 25\\%, 75\\%, 97.5\\%).}
\item{acc.rate}{Acceptance rate of the sampler.}
\item{call}{The matched call.}
}
}
\description{
Runs a Metropolis-Hastings MCMC algorithm with Gaussian random-walk proposals,
imputing right-censored observations at each iteration. Parameters constrained
to be positive are handled via a log-transformation.
}
\details{
At each iteration, censored observations are imputed from the conditional
distribution of the failure time given censoring. The sampler then performs
a Metropolis-Hastings step using the imputed dataset. The Jacobian adjustment
for positive parameters is automatically included.
}
\examples{
# Simulated censored data (Weibull)
set.seed(123)
n <- 30
t.true <- rweibull(n, shape=2, scale=1)
censor.limit <- 1.2
x <- pmin(t.true, censor.limit)
delta <- as.integer(t.true <= censor.limit)

# Log-posterior (up to a constant)
logPost <- function(theta, t.imp){
  shape <- theta[1]; scale <- theta[2]
  sum(dweibull(t.imp, shape=shape, scale=scale, log=TRUE))
}

out <- censoredRWmcmc(
  x = x, delta = delta, dist = "weibull",
  logPost = logPost, theta.init = c(1,1),
  positive = c(TRUE, TRUE), n.iter = 2000
)
str(out$summary)

}
